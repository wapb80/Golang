C칩digo actualizado
main.go
go
Copiar c칩digo
package main

import (
	"html/template"
	"net/http"

	"github.com/go-echarts/go-echarts/v2/charts"
	"github.com/go-echarts/go-echarts/v2/opts"
)

var templates = template.Must(template.ParseFiles("templates/index.html"))

// Genera datos ficticios para el gr치fico
func generateBarItems() []opts.BarData {
	items := make([]opts.BarData, 0)
	for i := 0; i < 7; i++ {
		items = append(items, opts.BarData{Value: i * 10})
	}
	return items
}

// Handler para la p치gina principal
func indexHandler(w http.ResponseWriter, r *http.Request) {
	templates.ExecuteTemplate(w, "index.html", nil)
}

// Handler para generar el gr치fico
func chartHandler(w http.ResponseWriter, r *http.Request) {
	// Crear un gr치fico de barras
	bar := charts.NewBar()
	bar.SetGlobalOptions(charts.WithTitleOpts(opts.Title{Title: "Gr치fico de Barras"}))
	bar.SetXAxis([]string{"Lunes", "Martes", "Mi칠rcoles", "Jueves", "Viernes", "S치bado", "Domingo"}).
		AddSeries("Categor칤a A", generateBarItems())

	// Renderizar el gr치fico como HTML
	w.Header().Set("Content-Type", "text/html")
	bar.Render(w)
}

func main() {
	http.HandleFunc("/", indexHandler)
	http.HandleFunc("/chart", chartHandler) // Endpoint para el gr치fico
	http.ListenAndServe(":8080", nil)
}
index.html
Actualizamos el bot칩n para cargar el gr치fico en el iframe.

html
Copiar c칩digo
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gr치fico en iframe</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: Arial, sans-serif;
        }
        iframe {
            width: 80%;
            height: 400px;
            border: 1px solid #ccc;
            margin-top: 20px;
        }
        button {
            padding: 10px 15px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Gr치fico Din치mico en un iframe</h1>
    <button id="loadChart">Cargar Gr치fico</button>
    <iframe id="chartFrame"></iframe>

    <script>
        document.getElementById('loadChart').addEventListener('click', function () {
            const iframe = document.getElementById('chartFrame');
            iframe.src = "/chart"; // Carga el gr치fico generado por el backend
        });
    </script>
</body>
</html>
Explicaci칩n de los cambios
Generaci칩n del gr치fico:

Usamos go-echarts para crear un gr치fico de barras con datos ficticios.
El gr치fico se genera en el endpoint /chart y se renderiza directamente como HTML.
Carga din치mica del gr치fico:

El bot칩n en index.html cambia el atributo src del iframe para apuntar al endpoint /chart, mostrando el gr치fico generado din치micamente.
Uso de estilos responsivos:

El iframe es configurado para ocupar el 80% del ancho de la p치gina y adaptarse al contenido generado.
Resultado
Cuando accedas a http://localhost:8080, ver치s el bot칩n para cargar el gr치fico.
Al hacer clic en "Cargar Gr치fico", se cargar치 un gr치fico interactivo de barras en el iframe.
쯊e gustar칤a agregar funcionalidades adicionales, como m치s tipos de gr치ficos o datos din치micos? 游땕






T칰 dijiste:
si , tengo en mente que el al presionar el boton id="loadChart", este tome las opciones seleccionadas en tres select diferentes ,por ejemplo edad, genero, nacionalidad , y esas valores los pase para generar el grafico, a demas quiero usar memcached para rederizar el grafico
ChatGPT Plus
ChatGPT
춰Claro! Vamos a extender tu aplicaci칩n para incluir:

Tres selectores (<select>): Para capturar las opciones de edad, g칠nero y nacionalidad.
Paso de datos al backend: Los valores seleccionados en los <select> ser치n enviados como par치metros al endpoint /chart.
Uso de Memcached: Para almacenar el gr치fico generado y evitar regenerarlo si ya existe para la misma combinaci칩n de par치metros.
Modificaciones necesarias
Dependencias adicionales
Instala Memcached y la biblioteca para Go:

bash
Copiar c칩digo
go get github.com/bradfitz/gomemcache/memcache
Aseg칰rate de que el servicio de Memcached est칠 en ejecuci칩n:

bash
Copiar c칩digo
memcached -d -m 64 -p 11211
Backend actualizado (main.go)
go
Copiar c칩digo
package main

import (
	"crypto/md5"
	"fmt"
	"net/http"
	"strings"

	"github.com/bradfitz/gomemcache/memcache"
	"github.com/go-echarts/go-echarts/v2/charts"
	"github.com/go-echarts/go-echarts/v2/opts"
)

var mc = memcache.New("127.0.0.1:11211")

// Genera datos ficticios para el gr치fico seg칰n los par치metros
func generateBarItems(params map[string]string) []opts.BarData {
	// L칩gica ficticia para generar datos con base en los par치metros
	items := make([]opts.BarData, 0)
	for i := 1; i <= 7; i++ {
		items = append(items, opts.BarData{Value: i * len(params["edad"])}) // Datos din치micos
	}
	return items
}

// Crea un hash 칰nico para los par치metros
func generateHash(params map[string]string) string {
	data := fmt.Sprintf("%s-%s-%s", params["edad"], params["genero"], params["nacionalidad"])
	return fmt.Sprintf("%x", md5.Sum([]byte(data)))
}

// Genera un gr치fico de barras basado en los par치metros
func createChart(params map[string]string) *charts.Bar {
	bar := charts.NewBar()
	bar.SetGlobalOptions(charts.WithTitleOpts(opts.Title{Title: "Gr치fico Din치mico"}))
	bar.SetXAxis([]string{"Lunes", "Martes", "Mi칠rcoles", "Jueves", "Viernes", "S치bado", "Domingo"}).
		AddSeries("Categor칤a A", generateBarItems(params))
	return bar
}

// Handler para la p치gina principal
func indexHandler(w http.ResponseWriter, r *http.Request) {
	http.ServeFile(w, r, "templates/index.html")
}

// Handler para generar o recuperar el gr치fico desde Memcached
func chartHandler(w http.ResponseWriter, r *http.Request) {
	params := map[string]string{
		"edad":         r.URL.Query().Get("edad"),
		"genero":       r.URL.Query().Get("genero"),
		"nacionalidad": r.URL.Query().Get("nacionalidad"),
	}

	// Generar un hash 칰nico basado en los par치metros
	hash := generateHash(params)

	// Intentar recuperar el gr치fico desde Memcached
	if item, err := mc.Get(hash); err == nil {
		w.Header().Set("Content-Type", "text/html")
		w.Write(item.Value)
		return
	}

	// Generar el gr치fico si no est치 en Memcached
	w.Header().Set("Content-Type", "text/html")
	bar := createChart(params)

	// Guardar el gr치fico generado en Memcached
	var sb strings.Builder
	bar.Render(&sb)
	mc.Set(&memcache.Item{Key: hash, Value: []byte(sb.String())})

	// Renderizar el gr치fico
	w.Write([]byte(sb.String()))
}

func main() {
	http.HandleFunc("/", indexHandler)
	http.HandleFunc("/chart", chartHandler)
	http.ListenAndServe(":8080", nil)
}
Frontend actualizado (index.html)
html
Copiar c칩digo
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gr치fico con Par치metros</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: Arial, sans-serif;
        }
        iframe {
            width: 80%;
            height: 400px;
            border: 1px solid #ccc;
            margin-top: 20px;
        }
        button {
            padding: 10px 15px;
            font-size: 16px;
            cursor: pointer;
        }
        select {
            margin: 5px;
            padding: 5px;
        }
    </style>
</head>
<body>
    <h1>Generar Gr치fico con Par치metros</h1>

    <!-- Selectores -->
    <label for="edad">Edad:</label>
    <select id="edad">
        <option value="20-30">20-30</option>
        <option value="30-40">30-40</option>
        <option value="40-50">40-50</option>
    </select>

    <label for="genero">G칠nero:</label>
    <select id="genero">
        <option value="M">Masculino</option>
        <option value="F">Femenino</option>
    </select>

    <label for="nacionalidad">Nacionalidad:</label>
    <select id="nacionalidad">
        <option value="Chile">Chile</option>
        <option value="Argentina">Argentina</option>
        <option value="Per칰">Per칰</option>
    </select>

    <button id="loadChart">Cargar Gr치fico</button>
    <iframe id="chartFrame"></iframe>

    <script>
        document.getElementById('loadChart').addEventListener('click', function () {
            const edad = document.getElementById('edad').value;
            const genero = document.getElementById('genero').value;
            const nacionalidad = document.getElementById('nacionalidad').value;

            const iframe = document.getElementById('chartFrame');
            iframe.src = `/chart?edad=${edad}&genero=${genero}&nacionalidad=${nacionalidad}`;
        });
    </script>
</body>
</html>
Explicaci칩n de los cambios
Selectores y par치metros:

El usuario selecciona valores de edad, g칠nero y nacionalidad. Estos valores se env칤an como par치metros en la URL (/chart?edad=...&genero=...&nacionalidad=...).
Memcached:

Cada combinaci칩n de par치metros genera un hash 칰nico.
Si el hash existe en Memcached, se devuelve el gr치fico almacenado sin regenerarlo.
Si no existe, se genera un gr치fico nuevo y se guarda en Memcached.
Gr치fico din치mico:

Los datos del gr치fico var칤an seg칰n los par치metros seleccionados.
Ventajas
Desempe침o mejorado: Usar Memcached evita recalcular gr치ficos id칠nticos.
Interactividad: El usuario puede generar gr치ficos din치micos basados en sus selecciones.